function loadScript(){function a(){navigator.onLine?createErrorMessage("We're having trouble reaching Google maps. Maybe a firewall is blocking them.","www.maps.googleapis.com"):createErrorMessage("You seem to be offline. Check your internet connection and reload the page.")}getJSONP("https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=false",initialize.name,a)}function initialize(){var a={center:{lat:27.495,lng:-109.969},zoom:16,panControl:!1,streetViewControl:!1,zoomControl:!1,mapTypeControl:!1,styles:[{elementType:"labels.icon",stylers:[{visibility:"off"}]}]};pin={path:"m5.7173 24.562c-6.148-10.931-6.5821-15.691-1.8615-20.412 4.3413-4.3413 10.181-4.3413 14.522 0 4.7683 4.7683 4.3293 9.6487-1.8444 20.501-2.7042 4.7537-5.1417 8.6382-5.4167 8.6322s-2.7048-3.9309-5.3995-8.722zm9.1995-9.4112c1.5469-1.5469 1.5469-6.0531 0-7.6s-6.0531-1.5469-7.6 0-1.5469 6.0531 0 7.6 6.0531 1.5469 7.6 0z",fillOpacity:1,strokeWeight:1,strokeColor:"#fff",scale:1.25,origin:new google.maps.Point(0,0),anchor:new google.maps.Point(10,33),setColor:function(a){var b=Object.create(pin);return b.fillColor=a,b}},type={food:{icon:"img/food.svg",marker:pin.setColor("#dd4229")},entertainment:{marker:pin.setColor("#3aa0ef")},nature:{marker:pin.setColor("#20be8c")},recreation:{marker:pin.setColor("#f352a5")}};var b=document.getElementById("map-canvas"),c=document.getElementById("topbar");c.removeClassName("hidden");var d=document.getElementsByClassName("placeslist")[0];d.removeClassName("hidden"),map=new google.maps.Map(b,a),infowindow=new google.maps.InfoWindow,initialLocations=[new Location("Lockers",'Sports restaurant and bar (Trying the "Michael Phelps" pizza is a must)',27.493913,-109.974022,type.food),new Location("Kiawa","University's restaurant",27.49356,-109.972613,type.food),new Location("DoÃ±a Magui","Homemade food",27.490329,-109.972748,type.food),new Location("Comedor ITSON","University's restaurant",27.491831,-109.970547,type.food),new Location("Cafeteria ITSON","University's restaurant",27.492045,-109.969547,type.food),new Location("Laguna del Nainari","",27.497699,-109.969851,type.nature),new Location("Parque infantil Ostimuri","",27.493909,-109.966797,type.recreation),new Location("Tomas Oroz Gaytan Stadium","Baseball stadium",27.492747,-109.954472,type.recreation)],viewModel=new ViewModel,ko.applyBindings(viewModel),viewModel.query.subscribe(viewModel.search)}function createErrorMessage(a,b){var c=document.createElement("div"),d=document.createTextNode(a+" "),e=document.createElement("a");e.setAttribute("href","http://www.isup.me/"+b);var f=document.createTextNode("Maybe their servers are down?");c.appendChild(d),b&&e.appendChild(f),c.appendChild(e),c.className="alert-box warning",c.setAttribute("data-alert","");var g=document.getElementById("messages");g.appendChild(c)}function regExpEscape(a){return a.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}function valueMatches(a,b){var c="i";return RegExp(regExpEscape(a.trim()),c).test(b)}function getJSON(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.onload=function(){if(d.status>=200&&d.status<400){var a=JSON.parse(d.responseText);b(a)}else c(d.status)},d.onerror=c(event),d.send()}function ajax(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.onload=function(){if(d.status>=200&&d.status<400){var a=d.responseText;b(a)}else c(d.status)},d.onerror=c,d.send()}function getJSONP(a,b,c){var d=document.createElement("script");d.type="text/javascript",d.src=a+"&callback="+b,d.onerror=c,d.onload=function(){this.remove()},document.body.appendChild(d)}var map,infowindow,initialLocations,viewModel,detailsViewModel,pin,type;window.onload=loadScript;var Location=function(a,b,c,d,e){var f=this;f.title=ko.observable(a),f.description=ko.observable(b),f.latitude=ko.observable(c),f.longitude=ko.observable(d),f.kind=ko.observable(e),f.icon=ko.observable(e.icon),f.marker=new google.maps.Marker({position:new google.maps.LatLng(f.latitude(),f.longitude()),map:map,icon:e.marker,animation:google.maps.Animation.DROP,title:f.title()}),google.maps.event.addListener(f.marker,"click",function(){parent.viewModel.openInfoWindow(f)})},ViewModel=function(){var a=this;a.query=ko.observable(""),a.queryResultsShown=ko.observable(!1),a.locations=ko.observableArray(initialLocations.slice()),a.currentLocation=ko.observable(a.locations()[0]),a.filter=ko.observable(""),a.showDetails=ko.observable(!1),a.activeDetails=ko.observable("info"),a.showResults=function(){a.queryResultsShown(!0)},a.setCurrentLocation=function(b){return(b=a.getLocation(b.title()))?(b!=a.currentLocation()?a.currentLocation().marker.setAnimation(null):a.currentLocation(),b.marker.setAnimation(google.maps.Animation.BOUNCE),map.panTo(b.marker.getPosition()),a.currentLocation(b)):void 0},a.getLocation=function(b){for(var c in a.locations())if(a.locations()[c].title()===b)return a.locations()[c]},a.showAllLocations=function(){a.showLocationsByKind("")},a.showFoodLocations=function(){a.showLocationsByKind(type.food)},a.showRecreationLocations=function(){a.showLocationsByKind(type.recreation)},a.showOutdoorsLocations=function(){a.showLocationsByKind(type.nature)},a.showLocationsByKind=function(b){a.filter(b),a.search(a.query())},a.isFilterAll=ko.pureComputed(function(){return a.isFilterActive("")},a),a.isFilterFood=ko.pureComputed(function(){return a.isFilterActive(type.food)},a),a.isFilterRecreation=ko.pureComputed(function(){return a.isFilterActive(type.recreation)},a),a.isFilterOutdoors=ko.pureComputed(function(){return a.isFilterActive(type.nature)},a),a.isFilterActive=function(b){return a.filter()===b?"active":""},a.hideDetails=ko.pureComputed(function(){return a.showDetails()?"":"hidden"},a),a.setActiveInfo=function(){return a.setActiveDetails("info")},a.setActiveComments=function(){return a.setActiveDetails("comments")},a.setActiveTweets=function(){return a.setActiveDetails("tweets")},a.setActivePhotos=function(){return a.setActiveDetails("photos")},a.setActiveDetails=function(b){a.activeDetails(b)},a.isActiveInfo=ko.pureComputed(function(){return a.areDetailsActive("info")},a),a.isActiveComments=ko.pureComputed(function(){return a.areDetailsActive("comments")},a),a.isActiveTweets=ko.pureComputed(function(){return a.areDetailsActive("tweets")},a),a.isActivePhotos=ko.pureComputed(function(){return a.areDetailsActive("photos")},a),a.areDetailsActive=function(b){return a.activeDetails()===b?"active":""},a.openInfoWindow=function(b){var c='<div tabindex="1" href="#"><h2 class="info-title">'+b.title()+'</h2><p class="info-description">'+b.description()+"</p></div>";infowindow.setContent(c),infowindow.open(map,b.marker),a.setCurrentLocation(b);var d=document.getElementById("placeslist-switcher");d.checked=!1,a.queryResultsShown(!1),a.showDetails(!0)},a.search=function(b){a.hideAllMarkers(),a.locations.removeAll();var c=[];for(var d in parent.initialLocations){var e=parent.initialLocations[d];!valueMatches(b,e.title())||e.kind()!==a.filter()&&a.filter()||(a.showMarker(e),c.push(e))}a.locations(c)},a.selectMarker=function(){a.locations().length&&(a.openInfoWindow(a.locations()[0]),a.query(""))},a.hideAllMarkers=function(){var b=a.locations();for(var c in a.locations())b[c].marker.setMap(null)},a.showMarker=function(a){a.marker.setMap(map)},google.maps.event.addListener(parent.infowindow,"domready",function(){var b=a.getLocation(parent.infowindow.getAnchor().title);b&&a.setCurrentLocation(b)}),google.maps.event.addListener(parent.infowindow,"closeclick",function(){a.currentLocation().marker.setAnimation(null),a.showDetails(!1)})};Element.prototype.removeClassName=function(a){if(this.hasClassName(a)){var b=this.className;this.className=b.replace(new RegExp("(?:^|\\s+)"+a+"(?:\\s+|$)","g"),"")}},Element.prototype.hasClassName=function(a){return new RegExp("(?:^|\\s+)"+a+"(?:\\s+|$)").test(this.className)};